<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <title>安心小夥伴</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0"> 
    <style>
        /* CSS 樣式開始 */
        body {
            font-family: Arial, sans-serif;
            display: flex;
            justify-content: center;
            /* 1. 【滿版優化】調整：從原本的 'align-items: center' 改為 'flex-start' */
            align-items: flex-start; 
            /* 2. 【滿版優化】調整：移除 min-height: 100vh，讓內容根據實際長度決定高度 */
            /* 但為了讓背景填滿，我們通常會保留 min-height: 100vh 讓背景填滿 */
            min-height: 100vh; 
            margin: 0;
            background-color: #f4f4f9;
            /* 3. 【滿版優化】移除頂部和底部的 padding，讓內容可以貼邊 */
            padding: 0; 
        }

        .container {
            background: white;
            /* 4. 【滿版優化】調整 padding: 針對手機做優化 */
            padding: 20px; 
            border-radius: 0; /* 5. 【滿版優化】移除圓角，讓內容與手機邊緣貼合 */
            box-shadow: none; /* 6. 【滿版優化】移除陰影，視覺上更乾淨 */
            width: 100%; /* 7. 【滿版優化】手機上寬度固定為 100% */
            max-width: 900px;
            text-align: center;
            box-sizing: border-box; 
        }

        h1 {
            color: #2c3e50;
            margin-bottom: 20px; 
            font-size: 1.8em; 
        }

        .scenario-buttons {
            margin-bottom: 20px; 
            /* 桌面/平板 3x3 網格佈局 */
            display: grid;
            grid-template-columns: repeat(3, 1fr); 
            gap: 10px; 
            justify-content: center;
        }

        .scenario-buttons button {
            padding: 12px 15px; 
            border: none;
            border-radius: 8px;
            background-color: #3498db;
            color: white;
            font-weight: bold;
            cursor: pointer;
            font-size: 16px; 
            transition: background-color 0.3s, transform 0.1s;
            word-break: break-all; 
        }

        .scenario-buttons button:hover {
            background-color: #2980b9;
        }

        #audioPlayer {
            width: 100%;
            margin-bottom: 25px; 
            border-radius: 4px;
        }

        /* 完整靜態字幕列表區塊 */
        #staticTranscriptContainer {
            text-align: left;
            padding: 10px; 
            background: #fcfcfc;
            border: 1px solid #ddd;
            border-radius: 8px;
            max-height: 300px; 
            overflow-y: auto; 
        }
        
        #staticTranscriptContainer h2 {
            font-size: 1.3em; 
            color: #3498db;
            border-bottom: 2px solid #3498db;
            padding-bottom: 5px;
            margin-top: 0;
            margin-bottom: 10px; 
            text-align: center;
        }
        
        #staticTranscriptList li {
            list-style: none;
            padding: 6px 0; 
            font-size: 1.0em; 
            border-bottom: 1px dotted #eee;
            display: flex; 
            line-height: 1.4; 
        }

        /* 說話者名稱欄位樣式 */
        #staticTranscriptList .speaker-label {
            min-width: 80px; 
            font-weight: bold;
            margin-right: 10px;
            text-align: right; 
            flex-shrink: 0; 
        }
        
        /* 回覆內容樣式 */
        #staticTranscriptList .reply-content {
            color: #e74c3c; 
            font-weight: bold;
            background: #fdeaea;
            padding: 2px 5px; 
            border-radius: 3px;
            flex-grow: 1; 
        }
        
        /* 元數據（如響鈴）樣式 */
        #staticTranscriptList .meta-content {
             color: #95a5a6;
             font-style: italic;
             flex-grow: 1; 
        }
        
        /* 隱藏不再需要的動態區塊 */
        #subtitleDisplay, #calibrationHint {
            display: none; 
        }
        
        /* Media Query for Mobile Devices (螢幕寬度小於 600px) */
        @media (max-width: 600px) {
            
            .container {
                /* 8. 【滿版優化】確保手機上 padding 貼合內容 */
                padding: 15px; 
                /* 9. 【滿版優化】讓 container 佔滿整個垂直空間，實現視覺上的 full-height */
                min-height: 100vh;
            }

            /* 手機上按鈕區改為 2 欄 */
            .scenario-buttons {
                grid-template-columns: repeat(2, 1fr); 
                gap: 8px; 
            }

            /* 讓台語爸這個較長的名稱自己佔據一行 */
            .scenario-buttons button:nth-child(9) { 
                grid-column: span 2; 
            }

            .scenario-buttons button {
                padding: 10px;
                font-size: 14px; 
            }
            
            h1 {
                font-size: 1.5em;
            }

            #staticTranscriptList li {
                font-size: 0.95em;
            }

            #staticTranscriptList .speaker-label {
                min-width: 60px; 
            }
        }
        
        /* 額外優化：Media Query for Very Small Phones (螢幕寬度小於 380px) */
        @media (max-width: 380px) {
             /* 極小螢幕下，按鈕區改為 1 欄 */
            .scenario-buttons {
                grid-template-columns: 1fr; 
            }
             /* 讓所有按鈕都佔滿 1 欄 */
            .scenario-buttons button {
                grid-column: span 1 !important; 
            }
        }
        
        /* CSS 樣式結束 */
    </style>
	<script src="https://static.line-scdn.net/liff/edge/2.3/sdk.js"></script>
</head>
<body>

    <div class="container">
        <h1>安心小夥伴</h1>

        <div class="scenario-buttons">
            <button onclick="loadScenario('friendm')">情境一：朋友男</button>
            <button onclick="loadScenario('friendg')">情境二：朋友女</button>
            <button onclick="loadScenario('safem')">情境三：安全搭車男</button>
            <button onclick="loadScenario('safeg')">情境四：安全搭車女</button>
            <button onclick="loadScenario('bf')">情境五：男朋友</button>
            <button onclick="loadScenario('gf')">情境六：女朋友</button>
            <button onclick="loadScenario('dad')">情境七：爸爸</button>
            <button onclick="loadScenario('mom')">情境八：媽媽</button>
            <button onclick="loadScenario('dad1')">情境九：台語爸</button>
        </div>
		<script>
    // 初始化 LIFF
    async function main() {
      await liff.init({ liffId: "2008106671-bpPJ99J3" });

      // 取得使用者資料
      document.getElementById("btn-profile") && document.getElementById("btn-profile").addEventListener("click", async () => {
        if (!liff.isLoggedIn()) {
          liff.login();
        } else {
          const profile = await liff.getProfile();
          alert(`Hello, ${profile.displayName}`);
        }
      });
    }

    main();
  </script>
        <audio id="audioPlayer" controls></audio>
        
        <div id="staticTranscriptContainer">
            <h2 id="transcriptTitle">請選擇一個情境來顯示完整對話</h2>
            <ul id="staticTranscriptList">
                </ul>
        </div>
    </div>
    
    <script>
        const SPEAKER_PARTNER = "小夥伴"; 
        const SPEAKER_USER = "你";      
        const RING_DURATION = 3.5; 
        
        // 1. 數據結構 (內容不變)
        const SCENARIOS = {
            // ------------------ 朋友模式 ------------------
            'friendm': {
                title: '朋友男',
                audioSrc: '朋友男.m4a',
                subtitles: [
                    { start: 0.00, end: 3.50, text: "（電話響鈴聲...）", type: 'meta' },
                    { start: 3.50, end: 5.00, text: "喂，你在哪裡？", speaker: SPEAKER_PARTNER }, 
                    { start: 5.00, end: 6.50, text: "（在路上了）", type: 'reply', speaker: SPEAKER_USER }, 
                    { start: 6.50, end: 7.50, text: "啊還要幾分鐘？", speaker: SPEAKER_PARTNER },
                    { start: 7.50, end: 9.00, text: "（？分鐘）", type: 'reply', speaker: SPEAKER_USER }, 
                    { start: 9.00, end: 11.50, text: "哦好啦那你到了說一下我去接你", speaker: SPEAKER_PARTNER },
                    { start: 11.50, end: 13.00, text: "（哦好啦掰）", type: 'reply', speaker: SPEAKER_USER, isEnd: true } 
                ]
            },
            'friendg': {
                title: '朋友女',
                audioSrc: '朋友女.m4a',
                subtitles: [
                    { start: 0.0, end: RING_DURATION, text: "（電話響鈴聲...）", type: 'meta' },
                    { start: RING_DURATION, end: 5.2, text: "喂，你在哪裡？", speaker: SPEAKER_PARTNER }, 
                    { start: 5.2, end: 6.7, text: "（在路上了）", type: 'reply', speaker: SPEAKER_USER }, 
                    { start: 6.7, end: 7.8, text: "啊還要幾分鐘？", speaker: SPEAKER_PARTNER },
                    { start: 7.8, end: 9.3, text: "（？分鐘）", type: 'reply', speaker: SPEAKER_USER }, 
                    { start: 9.3, end: 11.8, text: "哦好啦，那你到我說一下我去接你", speaker: SPEAKER_PARTNER },
                    { start: 11.8, end: 13.3, text: "（哦好啦掰）", type: 'reply', speaker: SPEAKER_USER, isEnd: true } 
                ]
            },

            // ------------------ 安全搭車模式 ------------------
            'safem': {
                title: '安全搭車男',
                audioSrc: '安全搭車男.m4a',
                subtitles: [
                    { start: 0.0, end: RING_DURATION, text: "（電話響鈴聲...）", type: 'meta' },
                    { start: RING_DURATION, end: 5.4, text: "喂，你上車了沒", speaker: SPEAKER_PARTNER },
                    { start: 5.4, end: 6.9, text: "（上車了）", type: 'reply', speaker: SPEAKER_USER }, 
                    { start: 6.9, end: 7.9, text: "阿你車牌多少", speaker: SPEAKER_PARTNER },
                    { start: 7.9, end: 9.4, text: "（xxxxxxx）", type: 'reply', speaker: SPEAKER_USER }, 
                    { start: 9.4, end: 11.4, text: "哦好啦注意安全喔等等見", speaker: SPEAKER_PARTNER },
                    { start: 11.4, end: 12.9, text: "（好掰）", type: 'reply', speaker: SPEAKER_USER, isEnd: true } 
                ]
            },
            'safeg': {
                title: '安全搭車女',
                audioSrc: '安全搭車女.m4a',
                subtitles: [
                    { start: 0.0, end: RING_DURATION, text: "（電話響鈴聲...）", type: 'meta' },
                    { start: RING_DURATION, end: 5.2, text: "喂，你上車了沒", speaker: SPEAKER_PARTNER },
                    { start: 5.2, end: 6.7, text: "（上車了）", type: 'reply', speaker: SPEAKER_USER }, 
                    { start: 6.7, end: 7.7, text: "啊你車牌多少", speaker: SPEAKER_PARTNER },
                    { start: 7.7, end: 9.2, text: "（xxxxxxx）", type: 'reply', speaker: SPEAKER_USER }, 
                    { start: 9.2, end: 11.0, text: "喔好啦注意安全喔等等見", speaker: SPEAKER_PARTNER },
                    { start: 11.0, end: 12.5, text: "（好掰）", type: 'reply', speaker: SPEAKER_USER, isEnd: true } 
                ]
            },

            // ------------------ 情侶模式 ------------------
            'bf': {
                title: '男朋友',
                audioSrc: '男友.m4a',
                subtitles: [
                    { start: 0.0, end: RING_DURATION, text: "（電話響鈴聲...）", type: 'meta' },
                    { start: RING_DURATION, end: 5.4, text: "喂，寶寶你到哪了？", speaker: SPEAKER_PARTNER },
                    { start: 5.4, end: 6.9, text: "（在路上了）", type: 'reply', speaker: SPEAKER_USER }, 
                    { start: 6.9, end: 10.5, text: "ㄛ好呀好呀那我等等買宵夜去給你吃哦", speaker: SPEAKER_PARTNER },
                    { start: 10.5, end: 12.0, text: "（好啊你真好💗）", type: 'reply', speaker: SPEAKER_USER }, 
                    { start: 12.0, end: 12.8, text: "阿你大概多久到？", speaker: SPEAKER_PARTNER },
                    { start: 12.8, end: 14.3, text: "（幾分鐘）", type: 'reply', speaker: SPEAKER_USER }, 
                    { start: 14.3, end: 15.6, text: "好啊等你過來喔～", speaker: SPEAKER_PARTNER },
                    { start: 15.6, end: 17.1, text: "（好的掰掰）", type: 'reply', speaker: SPEAKER_USER, isEnd: true } 
                ]
            },
            'gf': {
                title: '女朋友',
                audioSrc: '女友.m4a',
                subtitles: [
                    { start: 0.0, end: RING_DURATION, text: "（電話響鈴聲...）", type: 'meta' },
                    { start: RING_DURATION, end: 5.5, text: "喂，寶寶你到哪了？", speaker: SPEAKER_PARTNER },
                    { start: 5.5, end: 7.0, text: "（在路上了）", type: 'reply', speaker: SPEAKER_USER }, 
                    { start: 7.0, end: 9.5, text: "ㄛ好呀好呀那我等等買宵夜去給你吃哦", speaker: SPEAKER_PARTNER },
                    { start: 9.5, end: 11.0, text: "（好啊你真好💗）", type: 'reply', speaker: SPEAKER_USER }, 
                    { start: 11.0, end: 12.0, text: "阿你大概多久到？", speaker: SPEAKER_PARTNER },
                    { start: 12.0, end: 13.5, text: "（幾分鐘）", type: 'reply', speaker: SPEAKER_USER }, 
                    { start: 13.5, end: 15.0, text: "好啊等你過來喔～", speaker: SPEAKER_PARTNER },
                    { start: 15.0, end: 16.5, text: "（好的掰掰）", type: 'reply', speaker: SPEAKER_USER, isEnd: true } 
                ]
            },

            // ------------------ 家人模式 ------------------
            'dad': {
                title: '爸爸',
                audioSrc: '爸爸.m4a',
                subtitles: [
                    { start: 0.0, end: RING_DURATION, text: "（電話響鈴聲...）", type: 'meta' },
                    { start: RING_DURATION, end: 5.0, text: "喂，啊你要回來了沒？", speaker: SPEAKER_PARTNER },
                    { start: 5.0, end: 6.5, text: "（好啦好啦快到了啦）", type: 'reply', speaker: SPEAKER_USER }, 
                    { start: 6.5, end: 7.5, text: "啊還要多久？", speaker: SPEAKER_PARTNER },
                    { start: 7.5, end: 9.0, text: "（大概再？分鐘）", type: 'reply', speaker: SPEAKER_USER }, 
                    { start: 9.0, end: 10.8, text: "好啦那我把菜熱一熱等你回來", speaker: SPEAKER_PARTNER },
                    { start: 10.8, end: 12.3, text: "（好我知道了掰掰）", type: 'reply', speaker: SPEAKER_USER, isEnd: true } 
                ]
            },
            'mom': {
                title: '媽媽',
                audioSrc: '媽媽.m4a',
                subtitles: [
                    { start: 0.0, end: RING_DURATION, text: "（電話響鈴聲...）", type: 'meta' },
                    { start: RING_DURATION, end: 5.0, text: "喂，啊你回來了沒？", speaker: SPEAKER_PARTNER },
                    { start: 5.0, end: 6.5, text: "（好啦好啦快到了啦）", type: 'reply', speaker: SPEAKER_USER }, 
                    { start: 6.5, end: 7.5, text: "啊還要多久？", speaker: SPEAKER_PARTNER },
                    { start: 7.5, end: 9.0, text: "（大概再？分鐘）", type: 'reply', speaker: SPEAKER_USER }, 
                    { start: 9.0, end: 11.5, text: "好啦，那我把菜熱熱等你回來喔", speaker: SPEAKER_PARTNER },
                    { start: 11.5, end: 13.0, text: "（好我知道了掰掰）", type: 'reply', speaker: SPEAKER_USER, isEnd: true } 
                ]
            },
            'dad1': {
                title: '台語爸',
                audioSrc: '台語爸.m4a',
                subtitles: [
                    { start: 0.0, end: RING_DURATION, text: "（電話響鈴聲...）", type: 'meta' },
                    { start: RING_DURATION, end: 5.5, text: "喂，你已經到厝（tsù）矣無？", speaker: SPEAKER_PARTNER },
                    { start: 5.5, end: 7.0, text: "（好啦好啦快到了啦）", type: 'reply', speaker: SPEAKER_USER }, 
                    { start: 7.0, end: 8.0, text: "啊溝（koh）哇咕？", speaker: SPEAKER_PARTNER },
                    { start: 8.0, end: 9.5, text: "（大概再？分鐘）", type: 'reply', speaker: SPEAKER_USER }, 
                    { start: 9.5, end: 11.5, text: "好啦，哇丟（to̍h）給你按 等（án-tán）衝衝喔", speaker: SPEAKER_PARTNER },
                    { start: 11.5, end: 13.0, text: "（好我知道了掰掰）", type: 'reply', speaker: SPEAKER_USER, isEnd: true } 
                ]
            }
        };

        const audioPlayer = document.getElementById('audioPlayer');
        const staticTranscriptList = document.getElementById('staticTranscriptList');
        const transcriptTitle = document.getElementById('transcriptTitle');

        /**
         * 載入選定的情境音檔和字幕資料，並顯示完整對話
         */
        function loadScenario(scenarioKey) {
            const scenario = SCENARIOS[scenarioKey];
            if (!scenario) {
                transcriptTitle.textContent = "錯誤：找不到該情境數據。";
                return;
            }

            // 1. 停止並載入新的音訊來源
            audioPlayer.pause();
            audioPlayer.src = scenario.audioSrc;
            audioPlayer.load(); 

            // 2. 更新標題
            transcriptTitle.textContent = `完整對話內容：${scenario.title}`;
            
            // 3. 顯示完整靜態字幕列表
            displayFullTranscript(scenario.subtitles);
        }
        
        /**
         * 渲染完整對話內容到下方列表
         */
        function displayFullTranscript(subtitles) {
            staticTranscriptList.innerHTML = ''; // 清空舊內容
            subtitles.forEach((sub) => {
                const li = document.createElement('li');
                
                let speakerLabel = sub.speaker || ''; // 獲取說話者標籤
                let displayText = sub.text;
                let contentClass = '';
                
                // 檢查是否為回覆段落，並給予樣式
                if (sub.type === 'reply') {
                    contentClass = 'reply-content';
                } else if (sub.type === 'meta') {
                    contentClass = 'meta-content';
                }
                
                // 構建說話者標籤。如果是元數據，則speakerLabel為空。
                // 如果 speakerLabel 為空，則只顯示一個 min-width 的空 span。
                const speakerHtml = `<span class="speaker-label">${speakerLabel}${speakerLabel ? '：' : ''}</span>`;

                li.innerHTML = `
                    ${speakerHtml}
                    <span class="${contentClass}">${displayText}</span>
                `;
                staticTranscriptList.appendChild(li);
            });
        }
        
        // 頁面載入時，預設載入第一個情境
        window.onload = function() {
            loadScenario('friendm'); 
        };
    </script>

</body>
</html>